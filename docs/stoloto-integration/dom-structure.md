# Структура DOM сайта Столото

## Обзор

Данный документ описывает структуру DOM элементов на сайте Столото (https://www.stoloto.ru/ruslotto/game?viewType=favorite), основанную на анализе реального сайта через браузер.

## Основная структура страницы

### Заголовок и навигация

```html
<generic> <!-- Основной контейнер -->
  <generic> <!-- Боковая панель с лотереями -->
    <button class="Button_button__aXkCB Button_square__ND8Xs Button_squareMediumSize__NdTuf LotteriesSidebar_btn__6lOle">
      <!-- Кнопка переключения боковой панели -->
    </button>
    <generic> <!-- Список лотерей -->
      <link href="/ruslotto/game?int=left">Русское лото</link>
      <link href="/gzhl/game?int=left">Жилищная лотерея</link>
      <!-- ... другие лотереи -->
    </generic>
  </generic>
  
  <generic> <!-- Основной контент -->
    <generic> <!-- Верхняя панель -->
      <link href="/"><!-- Логотип --></link>
      <navigation>
        <generic>Меню</generic>
        <generic>
          <link href="/check-ticket?int=header">Проверка билетов</link>
          <button>Поддержка</button>
        </generic>
      </navigation>
      <link href="/auth?targetUrl=%2Fruslotto%2Fgame%3FviewType%3Dfavorite">Вход и регистрация</link>
    </generic>
  </generic>
</generic>
```

### Информация о тираже

```html
<generic> <!-- Блок информации о тираже -->
  <heading level="1">Русское лото</heading>
  <generic> <!-- Карусель тиражей -->
    <generic> <!-- Активный тираж -->
      <paragraph>Тираж № 1662</paragraph>
      <paragraph>23.07 ср •сайт</paragraph>
      <paragraph>Джекпот 800 000 000 ₽</paragraph>
      <paragraph>Золотой бочонок 9 000 000 ₽</paragraph>
      <generic>Минимальный выигрыш 200 ₽</generic>
    </generic>
    <!-- Другие тиражи -->
  </generic>
</generic>
```

## Интерфейс выбора чисел

### Блок выбора любимых чисел

```html
<generic> <!-- Контейнер выбора чисел -->
  <generic> <!-- Заголовок и инструкции -->
    <img> <!-- Иконка -->
    <generic>
      <text>Выберите до 7 любимых чисел — подберём с ними билеты</text>
      <img> <!-- Информационная иконка -->
    </generic>
    <button>Сбросить</button> <!-- Кнопка очистки выбора -->
  </generic>
  
  <generic> <!-- Сетка чисел от 1 до 90 -->
    <button>1</button>
    <button>2</button>
    <!-- ... -->
    <button active>7</button> <!-- Выбранное число -->
    <!-- ... -->
    <button>90</button>
  </generic>
</generic>

<button>Показать билеты</button> <!-- Кнопка поиска билетов -->
```

### Структура кнопок чисел

- **Обычная кнопка числа**: `<button>N</button>` где N - число от 1 до 90
- **Выбранная кнопка**: `<button active>N</button>` - имеет атрибут `active`
- **CSS классы**: Кнопки чисел не имеют специальных data-test-id атрибутов

## Структура билетов

### Контейнер билетов

```html
<generic> <!-- Контейнер с билетами -->
  <generic> <!-- Информация о выбранных числах -->
    <generic>Выбранные числа</generic>
    <paragraph>7</paragraph> <!-- Выбранные числа -->
    <button> <!-- Кнопка изменения -->
      <img>
    </button>
  </generic>
  
  <generic> <!-- Список билетов -->
    <button class="Ticket_btn__L4SXA"> <!-- Билет -->
      <generic> <!-- Заголовок билета -->
        <generic>Билет №999294021672</generic>
        <img> <!-- Иконка -->
      </generic>
      <generic> <!-- Числа билета, разделенные по строкам -->
        <!-- Строка 1 -->
        <generic>25</generic>
        <generic>55</generic>
        <generic>65</generic>
        <generic>71</generic>
        <generic>89</generic>
        <!-- Строка 2 -->
        <generic>3</generic>
        <generic>34</generic>
        <generic>47</generic>
        <generic>54</generic>
        <generic>75</generic>
        <!-- ... остальные строки -->
      </generic>
    </button>
    <!-- Другие билеты -->
  </generic>
  
  <button>Другие билеты</button> <!-- Кнопка загрузки новых билетов -->
</generic>
```

### Структура чисел в билете

Каждый билет содержит 90 чисел, организованных в 6 строк по 15 чисел в каждой:
- **Строки 1-3**: Верхняя половина билета
- **Строки 4-6**: Нижняя половина билета
- **Каждая строка**: 15 позиций, из которых заполнены только 9

**Важно**: Числа в билетах представлены как `<generic>N</generic>` элементы, а НЕ как элементы с `data-test-id="number"` или `data-test-id="selected-number"`.

## Элементы навигации и управления

### Кнопки управления

| Кнопка | Селектор | Описание |
|--------|----------|----------|
| Показать билеты | `button` с текстом "Показать билеты" | Запускает поиск билетов |
| Другие билеты | `button` с текстом "Другие билеты" | Загружает новую партию билетов |
| Сбросить | `button` с текстом "Сбросить" | Очищает выбранные числа |

### Навигационные ссылки

| Элемент | Селектор | Описание |
|---------|----------|----------|
| Билеты | `a[href="/ruslotto/game?viewType=tickets"]` | Переход к выбору билетов |
| Все числа | `a[href="/ruslotto/game?viewType=all"]` | Переход к режиму "все числа" |
| Свои числа | `a[href="/ruslotto/game?viewType=favorite"]` | Текущая страница |
| Архив тиражей | `a[href="/ruslotto/archive"]` | Архив результатов |

## Элементы аутентификации

### Неавторизованный пользователь

```html
<link href="/auth?targetUrl=%2Fruslotto%2Fgame%3FviewType%3Dfavorite">
  Вход и регистрация
</link>
```

### Авторизованный пользователь

Для авторизованных пользователей отображаются:
- Ссылка на кошелек: `a[href="/private/wallet?int=header"]`
- Ссылка на бонусы: `a[href="/private/bonus?int=header"]`
- Ссылка на билеты: `a[href="/private/tickets/all?int=header"]`

## Индикаторы загрузки и состояния

### Состояния страницы

- **Загрузка билетов**: После нажатия "Показать билеты" происходит загрузка с задержкой ~1 секунда
- **Загрузка новых билетов**: После нажатия "Другие билеты" загружается новая партия билетов
- **Выбор чисел**: Мгновенная реакция на клик по числам

### Визуальные индикаторы

- **Выбранные числа**: Кнопки получают атрибут `active`
- **Выбранные билеты**: Билеты могут изменять визуальное состояние при выборе

## Важные различия с кодом расширения

### Несоответствия в селекторах

1. **data-test-id атрибуты**: 
   - В коде расширения: `[data-test-id="number"]`, `[data-test-id="selected-number"]`
   - На реальном сайте: Найдено 530 элементов с `[data-test-id="number"]` и 10 с `[data-test-id="selected-number"]`, но они НЕ относятся к числам в билетах

2. **Кнопки управления**:
   - В коде расширения: `[data-test-id="show-tickets"]`, `[data-test-id="other-tickets"]`
   - На реальном сайте: Таких атрибутов НЕ найдено (0 элементов)

3. **Селекторы билетов**:
   - В коде расширения: `button[class*="Ticket_btn"]`
   - На реальном сайте: `button.Ticket_btn__L4SXA` ✅ (соответствует)

### Рекомендации по исправлению

1. **Числа в билетах**: Использовать селектор `generic` внутри билетов вместо `[data-test-id="number"]`
2. **Кнопки управления**: Искать по тексту кнопок вместо data-test-id
3. **Структура билета**: Учитывать реальную структуру с 6 строками по 15 позиций

## Заключение

Реальная структура сайта Столото значительно отличается от предположений в коде расширения. Основные элементы управления работают через поиск по тексту, а не через data-test-id атрибуты. Структура билетов более сложная и требует корректного парсинга для определения позиций чисел в строках и половинах билета.