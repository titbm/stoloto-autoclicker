# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ—Ç–ª–∞–¥–∫–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

## –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫, —Ç–µ—Ö–Ω–∏–∫–∏ –æ—Ç–ª–∞–¥–∫–∏ –∏ –º–µ—Ç–æ–¥—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è "–°—Ç–æ–ª–æ—Ç–æ –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä". –°–ª–µ–¥–æ–≤–∞–Ω–∏–µ —ç—Ç–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º –ø–æ–º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–µ—à–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ console.log –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—é –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

```javascript
// ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏
console.log('–ù–∞—á–∏–Ω–∞–µ–º —Ä–∞–±–æ—Ç—É —Å —á–∏—Å–ª–∞–º–∏:', numbers, '–∏—Å–∫–ª—é—á–∞—è:', excludeNumbers, '—Ä–µ–∂–∏–º:', mode);

// ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å –æ–±—ä–µ–∫—Ç–æ–º
console.log('–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', { 
    'profileMenu': !!profileMenu, 
    'userAvatar': !!userAvatar,
    'userNameElement': !!userNameElement,
    'personalCabinetElement': !!personalCabinetElement
});

// ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
console.log('–°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ:', {
    ticketsPurchased,
    totalTicketsToBuy,
    purchaseStartTime: purchaseStartTime ? new Date(purchaseStartTime).toLocaleTimeString() : null
});
```

### –ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

#### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∞
```javascript
// popup.js
console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è popup...');
console.log('–°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (—Å–≤–µ–∂–∏–π):', isUserAuthenticated);

// content.js
console.log('–°—Ç–æ–ª–æ—Ç–æ –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä: content script –∑–∞–≥—Ä—É–∂–µ–Ω');
console.log('–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏:', {
    isPurchaseMode,
    totalTicketsToBuy,
    ticketsPurchased
});
```

#### 2. –û–ø–µ—Ä–∞—Ü–∏–∏ —Å DOM
```javascript
console.log('–ù–∞–∂–∏–º–∞–µ–º –Ω–∞ —á–∏—Å–ª–æ:', num);
console.log('–ê–Ω–∞–ª–∏–∑ –±–∏–ª–µ—Ç–∞:', ticketNumber);
console.log('–ß–∏—Å–ª–∞ –≤ –±–∏–ª–µ—Ç–µ:', ticketNumbers);
console.log('‚úÖ –í—Å–µ —á–∏—Å–ª–∞ –Ω–∞–π–¥–µ–Ω—ã –≤ –ø–µ—Ä–≤–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ!');
console.log('‚ùå –í –±–∏–ª–µ—Ç–µ –Ω–∞–π–¥–µ–Ω—ã –∏—Å–∫–ª—é—á–∞–µ–º—ã–µ —á–∏—Å–ª–∞');
```

#### 3. –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –∏ –ø–æ–∫—É–ø–∫–∏
```javascript
console.log(`–ù–∞–π–¥–µ–Ω–æ ${foundTicketsOnPage.length} –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –±–∏–ª–µ—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ`);
console.log('‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –ø–æ–∫—É–ø–æ–∫:', ticketsPurchased);
console.log('‚è≥ –ù—É–∂–Ω–æ –∫—É–ø–∏—Ç—å –µ—â–µ –±–∏–ª–µ—Ç–æ–≤:', totalTicketsToBuy - ticketsPurchased);
```

#### 4. –û—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
```javascript
console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', error);
console.log('‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –Ω–æ –ø—ã—Ç–∞–µ—Ç—Å—è –≤–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –ø–æ–∫—É–ø–∫–∏');
console.log('–¢–∞–π–º–∞—É—Ç –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –±–∞–ª–∞–Ω—Å–∞');
```

## –¢–µ—Ö–Ω–∏–∫–∏ –æ—Ç–ª–∞–¥–∫–∏ Chrome DevTools –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π

### –û—Ç–ª–∞–¥–∫–∞ popup.js

1. **–û—Ç–∫—Ä—ã—Ç–∏–µ DevTools –¥–ª—è popup:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (–Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É)
   - –©–µ–ª–∫–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –Ω–∞ popup
   - –í—ã–±–µ—Ä–∏—Ç–µ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç" –∏–ª–∏ "Inspect"

2. **–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏:**
   ```javascript
   // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ—á–µ–∫ –æ—Å—Ç–∞–Ω–æ–≤–∞ –≤ –∫–æ–¥–µ
   debugger; // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
   
   // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
   console.log('Current auth status:', isUserAuthenticated);
   console.log('Button state:', button.disabled, button.textContent);
   
   // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
   button.addEventListener('click', (e) => {
       console.log('Button clicked, event:', e);
       debugger; // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
   });
   ```

### –û—Ç–ª–∞–¥–∫–∞ content.js

1. **–û—Ç–∫—Ä—ã—Ç–∏–µ DevTools –¥–ª—è content script:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –°—Ç–æ–ª–æ—Ç–æ
   - –ù–∞–∂–º–∏—Ç–µ F12 –∏–ª–∏ Ctrl+Shift+I
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Console"
   - –ù–∞–π–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç content script

2. **–û—Ç–ª–∞–¥–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å DOM:**
   ```javascript
   // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
   console.log('Buttons found:', document.querySelectorAll('button').length);
   console.log('Number buttons:', Array.from(document.querySelectorAll('button'))
       .filter(btn => /^\d+$/.test(btn.textContent.trim())));
   
   // –û—Ç–ª–∞–¥–∫–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
   const tickets = document.querySelectorAll('button[class*="Ticket_btn"]');
   console.log('Tickets found:', tickets.length);
   tickets.forEach((ticket, index) => {
       console.log(`Ticket ${index}:`, ticket.querySelector('[data-test-id="ticket-number"]')?.textContent);
   });
   ```

3. **–û—Ç–ª–∞–¥–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–∏—Å–∫–∞:**
   ```javascript
   // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ updateStatusBlock
   function updateStatusBlock(numbers, excludeNumbers, mode) {
       console.log('Updating status block:', {
           numbers,
           excludeNumbers,
           mode,
           ticketsChecked,
           isPurchaseMode,
           ticketsPurchased
       });
       
       // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
   }
   ```

### –û—Ç–ª–∞–¥–∫–∞ event_page.js (Service Worker)

1. **–û—Ç–∫—Ä—ã—Ç–∏–µ DevTools –¥–ª—è service worker:**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `chrome://extensions/`
   - –ù–∞–π–¥–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ "–°—Ç–æ–ª–æ—Ç–æ –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä"
   - –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏"
   - –ù–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è: service worker"

2. **–û—Ç–ª–∞–¥–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π:**
   ```javascript
   chrome.action.onClicked.addListener(async (tab) => {
       console.log('Extension icon clicked, tab:', tab.url);
       
       const workPageUrl = 'https://www.stoloto.ru/ruslotto/game?viewType=favorite';
       
       if (tab.url === workPageUrl) {
           console.log('Already on work page, opening popup');
       } else {
           console.log('Creating new tab with work page');
       }
   });
   ```

## –ü—Ä–æ—Ü–µ–¥—É—Ä—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

#### 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –±–∏–ª–µ—Ç–æ–≤

**–°—Ü–µ–Ω–∞—Ä–∏–π: –ü–æ–∏—Å–∫ –≤ —Ä–µ–∂–∏–º–µ "–ø–æ–ª–æ–≤–∏–Ω–∞"**
```javascript
// –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
const testNumbers = [1, 5, 10, 15, 20];
const testMode = 'half';

// –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
async function testHalfModeSearch() {
    console.log('=== –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –≤ —Ä–µ–∂–∏–º–µ "–ø–æ–ª–æ–≤–∏–Ω–∞" ===');
    
    // 1. –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –≤—ã–±–æ—Ä–∞
    await clearSelection();
    console.log('‚úì –í—ã–±–æ—Ä –æ—á–∏—â–µ–Ω');
    
    // 2. –í—ã–±–æ—Ä —á–∏—Å–µ–ª
    for (const num of testNumbers) {
        const button = Array.from(document.querySelectorAll('button'))
            .find(btn => btn.textContent.trim() === num.toString());
        
        if (button) {
            button.click();
            console.log(`‚úì –í—ã–±—Ä–∞–Ω–æ —á–∏—Å–ª–æ: ${num}`);
        } else {
            console.error(`‚úó –ù–µ –Ω–∞–π–¥–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –¥–ª—è —á–∏—Å–ª–∞: ${num}`);
        }
    }
    
    // 3. –ü–æ–∫–∞–∑ –±–∏–ª–µ—Ç–æ–≤
    const showButton = Array.from(document.querySelectorAll('button'))
        .find(btn => btn.textContent.trim() === '–ü–æ–∫–∞–∑–∞—Ç—å –±–∏–ª–µ—Ç—ã');
    
    if (showButton) {
        showButton.click();
        console.log('‚úì –ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –±–∏–ª–µ—Ç—ã"');
        
        // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏
        await new Promise(resolve => setTimeout(resolve, 2000));
        
        // 4. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        const tickets = document.querySelectorAll('button[class*="Ticket_btn"]');
        console.log(`‚úì –ù–∞–π–¥–µ–Ω–æ –±–∏–ª–µ—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞: ${tickets.length}`);
        
        let suitableTickets = 0;
        tickets.forEach((ticket, index) => {
            if (analyzeTicket(ticket, testNumbers)) {
                suitableTickets++;
                console.log(`‚úì –ë–∏–ª–µ—Ç ${index + 1} –ø–æ–¥—Ö–æ–¥–∏—Ç`);
            }
        });
        
        console.log(`=== –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–∞–π–¥–µ–Ω–æ ${suitableTickets} –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –±–∏–ª–µ—Ç–æ–≤ ===`);
    } else {
        console.error('‚úó –ù–µ –Ω–∞–π–¥–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –±–∏–ª–µ—Ç—ã"');
    }
}
```

**–°—Ü–µ–Ω–∞—Ä–∏–π: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è —á–∏—Å–µ–ª**
```javascript
async function testExcludeNumbers() {
    console.log('=== –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è —á–∏—Å–µ–ª ===');
    
    const searchNumbers = [1, 5, 10];
    const excludeNumbers = [7, 13, 25];
    
    // –ó–∞–ø—É—Å–∫ –ø–æ–∏—Å–∫–∞ —Å –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏
    await clickNumbers(searchNumbers, 'anywhere', excludeNumbers);
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –±–∏–ª–µ—Ç—ã –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏—Å–∫–ª—é—á–∞–µ–º—ã–µ —á–∏—Å–ª–∞
    const tickets = document.querySelectorAll('button[class*="Ticket_btn"]');
    
    tickets.forEach((ticket, index) => {
        const ticketNumbers = Array.from(ticket.querySelectorAll('[data-test-id="number"], [data-test-id="selected-number"]'))
            .map(num => parseInt(num.textContent.trim()))
            .filter(num => !isNaN(num));
        
        const hasExcluded = excludeNumbers.some(num => ticketNumbers.includes(num));
        
        if (hasExcluded) {
            console.error(`‚úó –ë–∏–ª–µ—Ç ${index + 1} —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å–∫–ª—é—á–∞–µ–º—ã–µ —á–∏—Å–ª–∞:`, 
                excludeNumbers.filter(num => ticketNumbers.includes(num)));
        } else {
            console.log(`‚úì –ë–∏–ª–µ—Ç ${index + 1} –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å–∫–ª—é—á–∞–µ–º—ã—Ö —á–∏—Å–µ–ª`);
        }
    });
}
```

#### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –ø–æ–∫—É–ø–∫–∏

**–°—Ü–µ–Ω–∞—Ä–∏–π: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–∫—É–ø–∫–∏**
```javascript
async function testPurchaseMode() {
    console.log('=== –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –ø–æ–∫—É–ø–∫–∏ ===');
    
    // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    const isLoggedIn = isUserLoggedIn();
    console.log('–°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', isLoggedIn);
    
    if (!isLoggedIn) {
        console.error('‚úó –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, —Ç–µ—Å—Ç –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω');
        return;
    }
    
    // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
    const balanceLink = document.querySelector('a[href="/private/wallet?int=header"]');
    if (balanceLink) {
        const balanceText = balanceLink.textContent.trim();
        console.log('–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å:', balanceText);
        
        const match = balanceText.match(/(\d+(?:\s\d+)*)\s*‚ÇΩ/);
        const balance = match ? parseInt(match[1].replace(/\s/g, '')) : 0;
        
        const requiredAmount = 150 * 2; // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–∫—É–ø–∫—É 2 –±–∏–ª–µ—Ç–æ–≤
        
        if (balance >= requiredAmount) {
            console.log(`‚úì –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ (${balance} >= ${requiredAmount})`);
        } else {
            console.warn(`‚ö† –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ (${balance} < ${requiredAmount})`);
        }
    }
    
    // 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–∫—É–ø–∫–∏
    isPurchaseMode = true;
    totalTicketsToBuy = 2;
    ticketsPurchased = 0;
    
    console.log('‚úì –†–µ–∂–∏–º –ø–æ–∫—É–ø–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω');
    console.log('–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:', { totalTicketsToBuy, ticketsPurchased });
    
    // 4. –ó–∞–ø—É—Å–∫ –ø–æ–∏—Å–∫–∞
    await clickNumbers([1, 5, 10, 15, 20], 'half', []);
}
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤

#### 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

```javascript
function testInvalidInputs() {
    console.log('=== –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö ===');
    
    // –¢–µ—Å—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ —á–∏—Å–µ–ª
    const testCases = [
        { input: '', expected: [] },
        { input: '1,2,3', expected: ['1', '2', '3'] },
        { input: '1, 2, 3', expected: ['1', '2', '3'] },
        { input: '0,91,abc,5', expected: ['5'] }, // –¢–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–Ω—ã–µ —á–∏—Å–ª–∞
        { input: '1,1,2,2,3', expected: ['1', '1', '2', '2', '3'] }, // –î—É–±–ª–∏–∫–∞—Ç—ã —Ä–∞–∑—Ä–µ—à–µ–Ω—ã
    ];
    
    testCases.forEach(({ input, expected }, index) => {
        const result = parseNumbers(input);
        const passed = JSON.stringify(result) === JSON.stringify(expected);
        
        console.log(`–¢–µ—Å—Ç ${index + 1}: ${passed ? '‚úì' : '‚úó'}`);
        console.log(`  –í–≤–æ–¥: "${input}"`);
        console.log(`  –û–∂–∏–¥–∞–µ—Ç—Å—è: [${expected.join(', ')}]`);
        console.log(`  –ü–æ–ª—É—á–µ–Ω–æ: [${result.join(', ')}]`);
        
        if (!passed) {
            console.error(`  ‚úó –¢–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω!`);
        }
    });
}
```

#### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≥–æ–Ω–∫–∏

```javascript
async function testRaceConditions() {
    console.log('=== –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≥–æ–Ω–∫–∏ ===');
    
    // –ë—ã—Å—Ç—Ä—ã–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É
    const button = document.getElementById('startButton');
    
    console.log('–¢–µ—Å—Ç–∏—Ä—É–µ–º –±—ã—Å—Ç—Ä—ã–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –Ω–∞–∂–∞—Ç–∏—è...');
    
    // –ò–º–∏—Ç–∏—Ä—É–µ–º –±—ã—Å—Ç—Ä—ã–µ –∫–ª–∏–∫–∏
    for (let i = 0; i < 5; i++) {
        button.click();
        console.log(`–ö–ª–∏–∫ ${i + 1}, disabled: ${button.disabled}`);
        await new Promise(resolve => setTimeout(resolve, 100));
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
    if (button.disabled) {
        console.log('‚úì –ö–Ω–æ–ø–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞');
    } else {
        console.error('‚úó –ö–Ω–æ–ø–∫–∞ –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ - –≤–æ–∑–º–æ–∂–Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ–Ω–∫–∏');
    }
}
```## 
–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

#### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

```javascript
function diagnoseAuthStatus() {
    console.log('=== –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ ===');
    
    // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    const authChecks = {
        profileMenu: !!document.querySelector('[data-test-id="profile-menu"], .profile-menu, .user-profile'),
        userAvatar: !!document.querySelector('.user-avatar, .account-avatar, [data-test-id="user-avatar"]'),
        userNameElement: !!document.querySelector('.profile-name, .user-name, .account-name'),
        walletElement: !!document.querySelector('.user-balance, .wallet, [data-test-id="user-balance"]'),
        balanceLink: !!document.querySelector('a[href="/private/wallet?int=header"]'),
        bonusLink: !!document.querySelector('a[href="/private/bonus?int=header"]')
    };
    
    console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', authChecks);
    
    // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–æ–≤ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
    const loginElements = Array.from(document.querySelectorAll('div, a, button, span'));
    const authBlock = loginElements.find(el => {
        if (!el || !el.textContent) return false;
        const text = el.textContent.trim().toLowerCase();
        return text === '–≤—Ö–æ–¥ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è' || text === '–≤–æ–π—Ç–∏' || text === '–≤—Ö–æ–¥';
    });
    
    console.log('–ë–ª–æ–∫ –≤—Ö–æ–¥–∞ –Ω–∞–π–¥–µ–Ω:', !!authBlock);
    if (authBlock) {
        console.log('–¢–µ–∫—Å—Ç –±–ª–æ–∫–∞ –≤—Ö–æ–¥–∞:', authBlock.textContent.trim());
    }
    
    // 3. –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞
    const positiveChecks = Object.values(authChecks).filter(Boolean).length;
    const hasLoginBlock = !!authBlock;
    
    console.log(`–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫: ${positiveChecks}/6`);
    console.log(`–ë–ª–æ–∫ –≤—Ö–æ–¥–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç: ${hasLoginBlock}`);
    
    const finalStatus = !hasLoginBlock && positiveChecks > 0;
    console.log(`–ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: ${finalStatus}`);
    
    return {
        isLoggedIn: finalStatus,
        checks: authChecks,
        hasLoginBlock,
        positiveChecks
    };
}
```

#### –ü—Ä–æ–±–ª–µ–º—ã —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

```javascript
async function diagnoseAuthCache() {
    console.log('=== –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫—ç—à–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ ===');
    
    // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Chrome Storage
    const data = await chrome.storage.local.get('authStatus');
    
    if (data.authStatus) {
        const age = Date.now() - data.authStatus.timestamp;
        const ageSeconds = Math.floor(age / 1000);
        
        console.log('–î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –∫—ç—à–µ:', {
            isLoggedIn: data.authStatus.isLoggedIn,
            timestamp: new Date(data.authStatus.timestamp).toLocaleString(),
            ageSeconds: ageSeconds,
            isRecent: ageSeconds < 10
        });
        
        if (ageSeconds > 10) {
            console.warn('‚ö† –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —É—Å—Ç–∞—Ä–µ–ª–∏');
        }
    } else {
        console.log('–î–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –∫—ç—à–µ –Ω–µ—Ç');
    }
    
    // 2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ç–µ–∫—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
    const currentStatus = diagnoseAuthStatus();
    
    if (data.authStatus && data.authStatus.isLoggedIn !== currentStatus.isLoggedIn) {
        console.error('‚úó –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –º–µ–∂–¥—É –∫—ç—à–µ–º –∏ —Ç–µ–∫—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º!');
        console.log('–ö—ç—à:', data.authStatus.isLoggedIn);
        console.log('–¢–µ–∫—É—â–µ–µ:', currentStatus.isLoggedIn);
    } else {
        console.log('‚úì –ö—ç—à —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–∫—É—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é');
    }
}
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø–æ–∫—É–ø–∫–∏

#### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–∫—É–ø–∫–∏

```javascript
async function diagnosePurchaseState() {
    console.log('=== –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–∫—É–ø–∫–∏ ===');
    
    // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏
    console.log('–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –ø–∞–º—è—Ç–∏:', {
        isPurchaseMode,
        totalTicketsToBuy,
        ticketsPurchased,
        purchaseSearchNumbers,
        purchaseExcludeNumbers,
        purchaseSearchMode,
        purchaseTicketsChecked,
        purchaseStartTime: purchaseStartTime ? new Date(purchaseStartTime).toLocaleString() : null
    });
    
    // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Chrome Storage
    const data = await chrome.storage.local.get('purchaseState');
    
    if (data.purchaseState) {
        console.log('–°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏ –≤ Storage:', {
            isPurchaseMode: data.purchaseState.isPurchaseMode,
            totalTicketsToBuy: data.purchaseState.totalTicketsToBuy,
            ticketsPurchased: data.purchaseState.ticketsPurchased,
            timestamp: new Date(data.purchaseState.timestamp).toLocaleString()
        });
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
        const memoryState = {
            isPurchaseMode,
            totalTicketsToBuy,
            ticketsPurchased
        };
        
        const storageState = {
            isPurchaseMode: data.purchaseState.isPurchaseMode,
            totalTicketsToBuy: data.purchaseState.totalTicketsToBuy,
            ticketsPurchased: data.purchaseState.ticketsPurchased
        };
        
        const isConsistent = JSON.stringify(memoryState) === JSON.stringify(storageState);
        
        if (isConsistent) {
            console.log('‚úì –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç Storage');
        } else {
            console.error('‚úó –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –º–µ–∂–¥—É –ø–∞–º—è—Ç—å—é –∏ Storage!');
            console.log('–ü–∞–º—è—Ç—å:', memoryState);
            console.log('Storage:', storageState);
        }
    } else {
        console.log('–°–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–∫—É–ø–∫–∏ –≤ Storage –Ω–µ—Ç');
        
        if (isPurchaseMode) {
            console.warn('‚ö† –†–µ–∂–∏–º –ø–æ–∫—É–ø–∫–∏ –∞–∫—Ç–∏–≤–µ–Ω –≤ –ø–∞–º—è—Ç–∏, –Ω–æ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ Storage');
        }
    }
    
    // 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏—á–µ—Å–∫–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏
    if (isPurchaseMode) {
        if (totalTicketsToBuy <= 0) {
            console.error('‚úó –†–µ–∂–∏–º –ø–æ–∫—É–ø–∫–∏ –∞–∫—Ç–∏–≤–µ–Ω, –Ω–æ totalTicketsToBuy <= 0');
        }
        
        if (ticketsPurchased > totalTicketsToBuy) {
            console.error('‚úó –ö—É–ø–ª–µ–Ω–æ –±–æ–ª—å—à–µ –±–∏–ª–µ—Ç–æ–≤ —á–µ–º –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª–æ—Å—å');
        }
        
        if (purchaseSearchNumbers.length === 0) {
            console.error('‚úó –†–µ–∂–∏–º –ø–æ–∫—É–ø–∫–∏ –∞–∫—Ç–∏–≤–µ–Ω, –Ω–æ —á–∏—Å–ª–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–µ –∑–∞–¥–∞–Ω—ã');
        }
    }
}
```

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å –±–∞–ª–∞–Ω—Å–æ–º

```javascript
function diagnoseBalanceIssues() {
    console.log('=== –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å –±–∞–ª–∞–Ω—Å–æ–º ===');
    
    // 1. –ü–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –±–∞–ª–∞–Ω—Å–∞
    const balanceLink = document.querySelector('a[href="/private/wallet?int=header"]');
    const bonusLink = document.querySelector('a[href="/private/bonus?int=header"]');
    
    console.log('–≠–ª–µ–º–µ–Ω—Ç—ã –Ω–∞–π–¥–µ–Ω—ã:', {
        balanceLink: !!balanceLink,
        bonusLink: !!bonusLink
    });
    
    if (balanceLink) {
        const balanceText = balanceLink.textContent.trim();
        console.log('–¢–µ–∫—Å—Ç –±–∞–ª–∞–Ω—Å–∞:', balanceText);
        
        // –ü–∞—Ä—Å–∏–Ω–≥ –±–∞–ª–∞–Ω—Å–∞
        const match = balanceText.match(/(\d+(?:\s\d+)*)\s*‚ÇΩ/);
        
        if (match) {
            const balance = parseInt(match[1].replace(/\s/g, ''));
            console.log('–†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π –±–∞–ª–∞–Ω—Å:', balance, '—Ä—É–±.');
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ–∫—É–ø–∫–∏
            const ticketPrice = 150;
            const maxTickets = Math.floor(balance / ticketPrice);
            console.log(`–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤: ${maxTickets}`);
            
        } else {
            console.error('‚úó –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –±–∞–ª–∞–Ω—Å –∏–∑ —Ç–µ–∫—Å—Ç–∞:', balanceText);
        }
    } else {
        console.error('‚úó –≠–ª–µ–º–µ–Ω—Ç –±–∞–ª–∞–Ω—Å–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω?');
    }
    
    if (bonusLink) {
        const bonusText = bonusLink.textContent.trim();
        console.log('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–æ–Ω—É—Å–æ–≤:', bonusText);
    }
}
```

## –û–±—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –æ—à–∏–±–æ–∫ –∏ —à–∞–≥–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

### 1. –û—à–∏–±–∫–∞ "–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ"

**–°–∏–º–ø—Ç–æ–º—ã:**
- Popup –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –Ω–æ –∫–Ω–æ–ø–∫–∞ "–ó–∞–ø—É—Å—Ç–∏—Ç—å" –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –í –∫–æ–Ω—Å–æ–ª–∏ –æ—à–∏–±–∫–∏ —Ç–∏–ø–∞ "Could not establish connection"

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```javascript
// –í popup.js –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–ª–∞–¥–∫—É
chrome.tabs.sendMessage(activeTab.id, {
    action: 'clickNumbers',
    numbers: numbers
}, (response) => {
    if (chrome.runtime.lastError) {
        console.error('Connection error:', chrome.runtime.lastError.message);
        console.log('Tab URL:', activeTab.url);
        console.log('Tab ID:', activeTab.id);
    }
});
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –°—Ç–æ–ª–æ—Ç–æ
2. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É (F5)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ content script –∑–∞–≥—Ä—É–∂–µ–Ω: –≤ –∫–æ–Ω—Å–æ–ª–∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ "–°—Ç–æ–ª–æ—Ç–æ –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä: content script –∑–∞–≥—Ä—É–∂–µ–Ω"

### 2. –û—à–∏–±–∫–∞ "–ß–∏—Å–ª–∞ –Ω–µ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è"

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ü–æ–∏—Å–∫ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –Ω–æ —á–∏—Å–ª–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–µ –Ω–∞–∂–∏–º–∞—é—Ç—Å—è
- –í –ª–æ–≥–∞—Ö —Å–æ–æ–±—â–µ–Ω–∏—è "–ö–Ω–æ–ø–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –¥–ª—è —á–∏—Å–ª–∞: X"

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ —Å —á–∏—Å–ª–∞–º–∏
const numberButtons = Array.from(document.querySelectorAll('button'))
    .filter(btn => /^\d+$/.test(btn.textContent.trim()));

console.log('–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ —Å —á–∏—Å–ª–∞–º–∏:', 
    numberButtons.map(btn => btn.textContent.trim()));

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∏—Å–ª–∞
const targetNumber = 5;
const button = Array.from(document.querySelectorAll('button'))
    .find(btn => btn.textContent.trim() === targetNumber.toString());

console.log(`–ö–Ω–æ–ø–∫–∞ –¥–ª—è —á–∏—Å–ª–∞ ${targetNumber}:`, button);
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω–∞
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ä–∞–∑–¥–µ–ª–µ —Å–∞–π—Ç–∞
3. –û–±–Ω–æ–≤–∏—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–∞–π—Ç–∞

### 3. –û—à–∏–±–∫–∞ "–ë–∏–ª–µ—Ç—ã –Ω–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è"

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ß–∏—Å–ª–∞ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è, –∫–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –±–∏–ª–µ—Ç—ã" –Ω–∞–∂–∏–º–∞–µ—Ç—Å—è
- –ù–æ –∞–Ω–∞–ª–∏–∑ –±–∏–ª–µ—Ç–æ–≤ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–∏–ª–µ—Ç–æ–≤
const tickets = document.querySelectorAll('button[class*="Ticket_btn"]');
console.log('–ù–∞–π–¥–µ–Ω–æ –±–∏–ª–µ—Ç–æ–≤:', tickets.length);

if (tickets.length > 0) {
    const firstTicket = tickets[0];
    console.log('–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Ä–≤–æ–≥–æ –±–∏–ª–µ—Ç–∞:');
    
    const numbers = firstTicket.querySelectorAll('[data-test-id="number"], [data-test-id="selected-number"]');
    console.log('–ß–∏—Å–ª–∞ –≤ –±–∏–ª–µ—Ç–µ:', numbers.length);
    
    numbers.forEach((num, index) => {
        console.log(`–ß–∏—Å–ª–æ ${index + 1}:`, num.textContent.trim());
    });
    
    const ticketNumber = firstTicket.querySelector('[data-test-id="ticket-number"]');
    console.log('–ù–æ–º–µ—Ä –±–∏–ª–µ—Ç–∞:', ticketNumber?.textContent);
}
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –±–∏–ª–µ—Ç–æ–≤ –∞–∫—Ç—É–∞–ª—å–Ω—ã
2. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –±–∏–ª–µ—Ç—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å (–¥–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É –∞–Ω–∞–ª–∏–∑–∞ –±–∏–ª–µ—Ç–æ–≤ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `analyzeTicket`

### 4. –ü—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ–∂–∏–º–æ–º –ø–æ–∫—É–ø–∫–∏

**–°–∏–º–ø—Ç–æ–º—ã:**
- –†–µ–∂–∏–º –ø–æ–∫—É–ø–∫–∏ –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è
- –ü–æ–∫—É–ø–∫–∞ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–∞–∂–µ –ø—Ä–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –±–∏–ª–µ—Ç–∞—Ö
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```javascript
// –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ä–µ–∂–∏–º–∞ –ø–æ–∫—É–ø–∫–∏
async function fullPurchaseDiagnosis() {
    console.log('=== –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ä–µ–∂–∏–º–∞ –ø–æ–∫—É–ø–∫–∏ ===');
    
    // 1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
    const authStatus = diagnoseAuthStatus();
    console.log('1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:', authStatus.isLoggedIn);
    
    // 2. –ë–∞–ª–∞–Ω—Å
    diagnoseBalanceIssues();
    
    // 3. –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏
    await diagnosePurchaseState();
    
    // 4. –ö–Ω–æ–ø–∫–∏ –æ–ø–ª–∞—Ç—ã
    const paymentButtons = checkPaymentButtons();
    console.log('4. –ö–Ω–æ–ø–∫–∏ –æ–ø–ª–∞—Ç—ã:', paymentButtons);
    
    // 5. –û–±—â–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å
    const isReady = authStatus.isLoggedIn && 
                   (paymentButtons.walletPaymentAvailable || paymentButtons.qrPaymentAvailable);
    
    console.log('5. –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø–æ–∫—É–ø–∫–µ:', isReady);
    
    return {
        authStatus,
        paymentButtons,
        isReady
    };
}
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å –±–∞–ª–∞–Ω—Å–∞
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–æ–∫ –æ–ø–ª–∞—Ç—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
4. –û—á–∏—Å—Ç–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏: `await resetPurchaseState()`

### 5. –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

**–°–∏–º–ø—Ç–æ–º—ã:**
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ
- –ë—Ä–∞—É–∑–µ—Ä –∑–∞–≤–∏—Å–∞–µ—Ç –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- –í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```javascript
// –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
function performanceMonitor() {
    const startTime = performance.now();
    
    // –í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å
    
    const endTime = performance.now();
    console.log(`–û–ø–µ—Ä–∞—Ü–∏—è –∑–∞–Ω—è–ª–∞ ${endTime - startTime} –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥`);
}

// –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–º—è—Ç–∏ (—Ç–æ–ª—å–∫–æ –≤ Chrome DevTools)
console.log('–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏:', performance.memory);
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–≤–µ–ª–∏—á–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä—ã DOM
3. –û—á–∏—â–∞—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `requestAnimationFrame` –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞

```javascript
// –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä
async function runAllTests() {
    console.log('üß™ –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —Ç–µ—Å—Ç–æ–≤...');
    
    const tests = [
        { name: '–ü–∞—Ä—Å–∏–Ω–≥ —á–∏—Å–µ–ª', fn: testInvalidInputs },
        { name: '–ü–æ–∏—Å–∫ –≤ —Ä–µ–∂–∏–º–µ "–ø–æ–ª–æ–≤–∏–Ω–∞"', fn: testHalfModeSearch },
        { name: '–ò—Å–∫–ª—é—á–µ–Ω–∏–µ —á–∏—Å–µ–ª', fn: testExcludeNumbers },
        { name: '–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏', fn: diagnoseAuthStatus },
        { name: '–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –±–∞–ª–∞–Ω—Å–∞', fn: diagnoseBalanceIssues },
        { name: '–°–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ–Ω–∫–∏', fn: testRaceConditions }
    ];
    
    const results = [];
    
    for (const test of tests) {
        console.log(`\n--- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞: ${test.name} ---`);
        
        try {
            const startTime = performance.now();
            await test.fn();
            const duration = performance.now() - startTime;
            
            results.push({
                name: test.name,
                status: 'PASSED',
                duration: Math.round(duration)
            });
            
            console.log(`‚úÖ ${test.name} - PASSED (${Math.round(duration)}ms)`);
        } catch (error) {
            results.push({
                name: test.name,
                status: 'FAILED',
                error: error.message
            });
            
            console.error(`‚ùå ${test.name} - FAILED:`, error);
        }
    }
    
    // –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç
    console.log('\nüìä –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:');
    console.table(results);
    
    const passed = results.filter(r => r.status === 'PASSED').length;
    const failed = results.filter(r => r.status === 'FAILED').length;
    
    console.log(`\n‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ: ${passed}`);
    console.log(`‚ùå –ü—Ä–æ–≤–∞–ª–µ–Ω–æ: ${failed}`);
    console.log(`üìà –£—Å–ø–µ—à–Ω–æ—Å—Ç—å: ${Math.round(passed / results.length * 100)}%`);
}

// –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
// runAllTests();
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –æ—Ç–ª–∞–¥–∫–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è "–°—Ç–æ–ª–æ—Ç–æ –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä". –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç—Ç–∏—Ö —Ç–µ—Ö–Ω–∏–∫ –ø–æ–º–æ–∂–µ—Ç:

1. **–ë—ã—Å—Ç—Ä–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã** —Å –ø–æ–º–æ—â—å—é —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
2. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –∫–æ–¥** –∏—Å–ø–æ–ª—å–∑—É—è Chrome DevTools
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏** –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
4. **–†–µ—à–∞—Ç—å —Ç–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã** —Å–ª–µ–¥—É—è –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–º –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –ø—Ä–æ–±–ª–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
- –î–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –†–∞—Å—à–∏—Ä—è—Ç—å –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
- –û–±–Ω–æ–≤–ª—è—Ç—å —ç—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ